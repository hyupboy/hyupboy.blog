---
title: 'Kubernetes ì‹¤ì „ ê¸°ë³¸ ê°œë… - 3ï¸âƒ£ Deployment'
date: '2025-04-17'
lastmod: '2025-04-18'
tags: ['kubernetes', 'study']
draft: false
summary: 'Kubernetes Deployment'
---

## Backgroud

â€¢ DeploymentëŠ” ê°€ì¥ ìì£¼ ì“°ì´ëŠ” ë¦¬ì†ŒìŠ¤ ì¤‘ í•˜ë‚˜ë¡œ, ì¼ì •í•˜ê²Œ íŒŒë“œë¥¼ ìœ ì§€í•˜ì—¬ ê´€ë¦¬í•˜ë„ë¡ í•¨   
â€¢ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬(Deploy)í•˜ê³  ê´€ë¦¬(Manage)í•˜ë©° ì—…ë°ì´íŠ¸(Update)í•˜ëŠ” ë° ì‚¬ìš©

<TOCInline toc={props.toc} exclude="Backgroud" />

## Kubernetes Deploymentë€ ?

Kubernetes DeploymentëŠ” ì»¨í…Œì´ë„ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„ ì–¸ì  ì—…ë°ì´íŠ¸ë¥¼ ê´€ë¦¬í•˜ëŠ” Kubernetes ì˜¤ë¸Œì íŠ¸ì•¼ !

## ğŸ§± êµ¬ì„± ìš”ì†Œ
DeploymentëŠ” ì£¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ì—­í• ì„ í•¨  
âœ… Pod ì •ì˜ ë° Replica ìˆ˜ ì„¤ì •  
  ex) "nginx ì»¨í…Œì´ë„ˆë¥¼ 3ê°œ ì‹¤í–‰ì‹œì¼œì¤˜!"  
  â€¢ ë‚´ë¶€ì ìœ¼ë¡œëŠ” ReplicaSetì„ ìƒì„±í•˜ê³  ê´€ë¦¬  
âœ…  Self-Healing  
  â€¢ Podê°€ ì£½ìœ¼ë©´ ìë™ìœ¼ë¡œ ì¬ìƒì„±  
  â€¢ Rolling Update ì§€ì›  
  â€¢ ë‹¤ìš´íƒ€ì„ ì—†ì´ ìƒˆë¡œìš´ ë²„ì „ì˜ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¡œ êµì²´ ê°€ëŠ¥  
âœ…  Rollback ê¸°ëŠ¥  
  â€¢ ë¬¸ì œê°€ ìƒê¸°ë©´ ì´ì „ ë²„ì „ìœ¼ë¡œ ë˜ëŒë¦´ ìˆ˜ ìˆìŒ  


## ğŸ“ ì˜ˆì‹œ deployment.yamlAML

```yaml:deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.21
        ports:
        - containerPort: 80
```

## ğŸš€ ì‹¤ì œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤  
âœ… ìƒˆë¡œìš´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•  ë•Œ  
âœ… ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œ (ì˜ˆ: nginx:1.21 â†’ nginx:1.22)  
âœ… ì„œë¹„ìŠ¤ ë¬´ì¤‘ë‹¨ ë°°í¬ë¥¼ í•˜ê³  ì‹¶ì„ ë•Œ  


## ğŸ“Š ë‹¤ë¥¸ ì˜¤ë¸Œì íŠ¸ì™€ ë¹„êµ (Deployment vs. ReplicaSet vs. StatefulSet vs. DaemonSet)  

í•­ëª© | Deployment | ReplicaSet | StatefulSet | DaemonSet
|--------|--------|--------|--------|--------|
ì£¼ ì‚¬ìš© ëŒ€ìƒ | Stateless ì•± | ë‚´ë¶€ êµ¬ì„±ìš”ì†Œ | Stateful ì•± (DB ë“±) | ë…¸ë“œ ë‹¨ìœ„ ë°ëª¬
ê³ ìœ í•œ Pod ì´ë¦„ | âŒ | âŒ | âœ… (pod-0, pod-1) | âŒ
ë¡¤ë§ ì—…ë°ì´íŠ¸ | âœ… | âŒ | ì¼ë¶€ ì§€ì› | ì œí•œì 
ìë™ ë³µêµ¬ | âœ… | âœ… | âœ… | âœ…
ìˆœì°¨ì  ë°°í¬ | âŒ | âŒ | âœ… | âœ…
ì§ì ‘ ì‚¬ìš© ì—¬ë¶€ | ìì£¼ ì‚¬ìš© | ê±°ì˜ ì•ˆ í•¨ | íŠ¹ì • ìƒí™©ì— ì‚¬ìš© | ì‹œìŠ¤í…œ ê´€ë¦¬ ëª©ì 


ğŸ“ ì˜ˆì‹œ replicaset.yaml (ë³´í†µì€ ì§ì ‘ ì•ˆ ì”€)

```yaml:replicaset.yaml
apiVersion: apps/v1
kind: ReplicaSet
metadata:
  name: nginx-replicaset
spec:
  replicas: 2
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.21
        ports:
        - containerPort: 80

```
â€» ì£¼ì˜: ìœ„ ë‚´ìš©ì€ Deployment ì—†ì´ ReplicaSetë§Œ ì‚¬ìš©í•œ ì˜ˆì‹œ, íŠ¹ë³„í•œ ì´ìœ  ì—†ìœ¼ë©´ ë³´í†µ Deployment ì‚¬ìš©  

ğŸ“ ì˜ˆì‹œ statefulSet.yaml (ìƒíƒœ ì €ì¥ ì„œë¹„ìŠ¤ìš©)

```yaml:replicaset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: mysql
spec:
  serviceName: "mysql"  # Headless ì„œë¹„ìŠ¤ í•„ìš”
  replicas: 2
  selector:
    matchLabels:
      app: mysql
  template:
    metadata:
      labels:
        app: mysql
    spec:
      containers:
      - name: mysql
        image: mysql:5.7
        ports:
        - containerPort: 3306
        env:
        - name: MYSQL_ROOT_PASSWORD
          value: "password"
        volumeMounts:
        - name: mysql-pvc
          mountPath: /var/lib/mysql
  volumeClaimTemplates:
  - metadata:
      name: mysql-pvc
    spec:
      accessModes: [ "ReadWriteOnce" ]
      resources:
        requests:
          storage: 1Gis
```

ğŸ“ ì˜ˆì‹œ replicaset.yaml (Nodeë³„ë¡œ 1ê°œì”© ì‹¤í–‰)  

```yaml:replicaset.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: node-exporter
spec:
  selector:
    matchLabels:
      name: node-exporter
  template:
    metadata:
      labels:
        name: node-exporter
    spec:
      containers:
      - name: node-exporter
        image: prom/node-exporter:latest
        ports:
        - containerPort: 9100

```
